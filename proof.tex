\documentclass{article}
%[twocolumn]

% ~~~~~~~~~~~~~~~~~~~~~~~ Preamble ~~~~~~~~~~~~~~~~~~~~~~~

\usepackage{bpextra}
\usepackage[margin=1.5in]{geometry}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{subcaption}
\usepackage{float}
\usepackage{enumitem}
\usepackage{titlesec}
\usepackage{latexsym}


%\titleformat{\section}
%  {\normalfont\scshape}{\thesection}{1em}{}

% no paragraph indent
\setlength{\parindent}{0pt}
\setlength{\columnsep}{2em}

% delta-equals (unused)
\def\deltaeq{\mathrel{\ensurestackMath{\stackon[1pt]{=}{\scriptstyle\Delta}}}}
\def\defeq{::=}


% indented definitions, lemmas etc
\makeatletter
\newtheoremstyle{indented}
    {5pt}% space before
    {5pt}% space after
    {\addtolength{\@totalleftmargin}{1em}
     \addtolength{\linewidth}{-2em}
     \parshape 1 1em \linewidth}% body font
    {-1em}% indent
    {\bfseries}% header font
    {.}% punctuation
    {.5em}% after theorem header
    {}% header specification (empty for default)
\makeatother

% theorems with global counter
\theoremstyle{indented}
\newtheorem{sec-ctr}{???}[section]
\newtheorem{theorem}[sec-ctr]{Theorem}
\newtheorem{definition}[sec-ctr]{Definition}
\newtheorem*{definition*}{Definition}
\newtheorem{proposition}[sec-ctr]{Proposition}
\newtheorem*{proposition*}{Proposition}
\newtheorem{lemma}[sec-ctr]{Lemma}
\newtheorem*{lemma*}{Lemma}
\newtheorem{example}[sec-ctr]{Example}
\newtheorem*{example*}{Example}
\newtheorem*{examples}{Examples}
\newtheorem{corollary}[sec-ctr]{Corollary}
\newtheorem*{corollary*}{Corollary}
\newtheorem{remark}[sec-ctr]{Remark}
\newtheorem*{remark*}{Remark}
\newtheorem*{remarks}{Remarks}


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


\title{Natural Proof Search for Classical Logic}
\author{Adam Lassiter\\Department of Computer Science\\University of Bath \and Willem Heijltjes\\Department of Computer Science\\University of Bath}
\date{\today}

\begin{document}
    \maketitle
    \begin{abstract}
        \textbf{We investigate a natural algorithm for proof search within classical logic.}
    \end{abstract}

    \section{Classical Logic}

        \begin{definition}{Formulae\\}
            A \textit{formula} within classical logic is constructed as follows:
            \begin{align*}
                \quad A, B, C                &\defeq \bot \,|\, \top \,|\, a \,|\, \neg\, a \,|\, A \vee B \,|\, A \wedge B \\
                \quad \Gamma, \Delta, \Sigma &\defeq A_1 \ldots A_n
            \end{align*}
            where $\vee, \wedge$ are additive linear logic disjunction and conjunction respectively and $\Gamma, \Delta, \Sigma$ are contexts..
        \end{definition}

        \begin{example*}
        \end{example*}


        \begin{definition}{Sequent Proofs\\}
            Within \textit{classical logic}, a \textit{sequent proof} is constructed from the following rules:\\
            \begin{minipage}[H]{\linewidth}
                \centering
                \begin{minipage}[H]{.3\linewidth}
                    \begin{prooftree}
                        \AxiomC{~}
                        \RightLabel{$\top$}
                        \UnaryInfC{$\vdash \top$}
                    \end{prooftree}
                    \begin{prooftree}
                        \AxiomC{~}
                        \RightLabel{$ax$}
                        \UnaryInfC{$\vdash a, \neg\, a$}
                    \end{prooftree}
                \end{minipage}
                \begin{minipage}[H]{.3\linewidth}
                    \begin{prooftree}
                        \AxiomC{$\vdash \Gamma, A$}
                        \RightLabel{$\vee$R}
                        \UnaryInfC{$\vdash \Gamma, A \vee B$}
                    \end{prooftree}
                    \begin{prooftree}
                        \AxiomC{$\vdash \Gamma, A$}
                        \AxiomC{$\vdash \Gamma, B$}
                        \RightLabel{$\wedge$R}
                        \BinaryInfC{$\vdash \Gamma, A \wedge B$}
                    \end{prooftree}
                \end{minipage}
                \begin{minipage}[H]{.3\linewidth}
                    \begin{prooftree}
                        \AxiomC{$\vdash \Gamma$}
                        \RightLabel{$w$}
                        \UnaryInfC{$\vdash \Gamma, A$}
                    \end{prooftree}
                    \begin{prooftree}
                        \AxiomC{$\vdash \Gamma, A, A$}
                        \RightLabel{$c$}
                        \UnaryInfC{$\vdash \Gamma, A$}
                    \end{prooftree}
                \end{minipage}
            \end{minipage}~\\
            where $A, B, C$ are formulae and $\Gamma, \Delta, \Sigma$ are sequents.
            A sequent proof provides, without context, a proof of its conclusion and each line of the proof represents a tautology.
        \end{definition}

        \begin{example*}
        \end{example*}


        \begin{remark}
            Within the context of weakening and contraction, \textit{additive} and \textit{multiplicative} rules are inter-derivable.
        \end{remark}


        \begin{definition}{Derivations\\}
            Given \textit{tops} $\Gamma_1 \ldots \Gamma_n$ for the sequent proof $\vdash \Delta$, a \textit{derivation} is a tree providing a proof of $\Gamma_1 \ldots \Gamma_n \implies \Delta$.\\

            A derivation is written as:
            \begin{prooftree}
                \AxiomC{$\vdash \Gamma_1$}
                \AxiomC{$\ldots$}
                \AxiomC{$\vdash \Gamma_n$}
                \RightLabel{\textit{[label]}} \doubleLine\TrinaryInfC{$\vdash \Delta$}
            \end{prooftree}
            where the \textit{label} describes which rules may be used within the derivation.
        \end{definition}

        \begin{corollary}{Derivation Equivalence\\}
            A sequent proof is a derivation where all top derivations of the tree are $=\joinrel= \top, ax$.
            Equivalence of derivations may be weakly defined up to equivalence of leaves and conclusion.
        \end{corollary}

        \begin{example*}
        \end{example*}


        \begin{definition}{Additive Stratification\\}
            A proof tree is said to be \textit{additively stratified} if $\vdash P$ is structured as follows:
            \begin{prooftree}
                \AxiomC{}
                \RightLabel{$\top, ax$}\doubleLine\UnaryInfC{$\vdash A_1$}
                \RightLabel{$w$}\doubleLine\UnaryInfC{$\vdash \Gamma_1$}
                \AxiomC{\ldots}
                \AxiomC{}
                \RightLabel{$\top, ax$}\doubleLine\UnaryInfC{$\vdash A_n$}
                \RightLabel{$w$}\doubleLine\UnaryInfC{$\vdash \Gamma_n$}
                \RightLabel{$\wedge, \vee$}\doubleLine\TrinaryInfC{$\vdash P \ldots P$}
                \RightLabel{$c$}\doubleLine\UnaryInfC{$\vdash P$}
            \end{prooftree}
            That is, the inferences made in an additively stratified proof are strictly ordered by:
            \setlist{nolistsep}
            \begin{enumerate}[noitemsep]
                \item Top/Axiomatic
                \item Weakening
                \item Conjunction/Disjunction
                \item Contraction
            \end{enumerate}
        \end{definition}
        
        \begin{example*}
        \end{example*}
        \begin{theorem}{Stratification Equivalence\\}
            Given $\vdash A$, there exists an additively stratified proof of $A$.
        \end{theorem}
        \begin{proof}
            For each instance of a weakening below another inference, there exists an equivalent subproof that is additively stratified:\\~\\
            \begin{minipage}[H]{\linewidth}
                \centering
                \begin{minipage}[H]{0.3\linewidth}
                    \begin{prooftree}
                        \AxiomC{$\vdash \Gamma, A, B$}
                        \RightLabel{$\vee$}\UnaryInfC{$\vdash \Gamma, A \vee B$}
                        \RightLabel{$w$}\UnaryInfC{$\vdash \Gamma, A \vee B$, C}
                    \end{prooftree}
                \end{minipage}
                $\leadsto$
                \begin{minipage}[H]{0.3\linewidth}
                    \begin{prooftree}
                        \AxiomC{$\vdash \Gamma, A, B$}
                        \RightLabel{$w$}\UnaryInfC{$\vdash \Gamma, A, B, C$}
                        \RightLabel{$\vee$}\UnaryInfC{$\vdash \Gamma, A \vee B$, C}
                    \end{prooftree}
                \end{minipage}
            \end{minipage}\\~\\
            
            \begin{minipage}[H]{\linewidth}
                \centering
                \begin{minipage}[H]{0.3\linewidth}
                    \begin{prooftree}
                        \AxiomC{$\vdash \Gamma, A$}
                        \AxiomC{$\vdash \Gamma, B$}
                        \RightLabel{$\wedge$}\BinaryInfC{$\vdash \Gamma, A \wedge B$}
                        \RightLabel{$w$}\UnaryInfC{$\vdash \Gamma, A \wedge B, C$}
                    \end{prooftree}
                \end{minipage}
                $\leadsto\quad$
                \begin{minipage}[H]{0.3\linewidth}
                    \begin{prooftree}
                        \AxiomC{$\vdash \Gamma, A$}
                        \RightLabel{$w$}\UnaryInfC{$\vdash \Gamma, A, C$}
                        \AxiomC{$\vdash \Gamma, B$}
                        \RightLabel{$w$}\UnaryInfC{$\vdash \Gamma, B, C$}
                        \RightLabel{$\wedge$}\BinaryInfC{$\vdash \Gamma, A \wedge B, C$}
                    \end{prooftree}
                \end{minipage}
            \end{minipage}\\~\\

            \begin{minipage}[H]{\linewidth}
                \centering
                \begin{minipage}[H]{0.3\linewidth}
                    \begin{prooftree}
                        \AxiomC{$\vdash \Gamma, A, A$}
                        \RightLabel{$c$}\UnaryInfC{$\vdash \Gamma, A$}
                        \RightLabel{$w$}\UnaryInfC{$\vdash \Gamma, A, B$}
                    \end{prooftree}
                \end{minipage}
                $\leadsto\quad$
                \begin{minipage}[H]{0.3\linewidth}
                    \begin{prooftree}
                        \AxiomC{$\vdash \Gamma, A, A$}
                        \RightLabel{$w$}\UnaryInfC{$\vdash \Gamma, A, A, B$}
                        \RightLabel{$c$}\UnaryInfC{$\vdash \Gamma, A, B$}
                    \end{prooftree}
                \end{minipage}
            \end{minipage}\\~\\

            Similarly, for each instance of a contraction above another inference, there exists an equivalent subproof that is additively stratified:\\
            \begin{minipage}[H]{\linewidth}
                \centering
                \begin{minipage}[H]{0.3\linewidth}
                    \begin{prooftree}
                        \AxiomC{$\vdash \Gamma, A, A, B$}
                        \RightLabel{$c$}\UnaryInfC{$\vdash \Gamma, A, B$}
                        \RightLabel{$\vee$}\UnaryInfC{$\vdash \Gamma, A \vee B$}
                    \end{prooftree}
                \end{minipage}
                $\leadsto$
                \begin{minipage}[H]{0.3\linewidth}
                    \begin{prooftree}
                        \AxiomC{$\vdash \Gamma, A, A, B$}
                        \RightLabel{$w$}\UnaryInfC{$\vdash \Gamma, A, A, B, B$}
                        \RightLabel{$\vee$}\UnaryInfC{$\vdash \Gamma, A \vee B, A, B$}
                        \RightLabel{$\vee$}\UnaryInfC{$\vdash \Gamma, A \vee B, A \vee B$}
                        \RightLabel{$c$}\UnaryInfC{$\vdash \Gamma, A \vee B$}
                    \end{prooftree}
                \end{minipage}
            \end{minipage}\\~\\

            \begin{minipage}[H]{\linewidth}
                \centering
                \begin{minipage}[H]{0.3\linewidth}
                    \begin{prooftree}
                        \AxiomC{$\vdash \Gamma, A, A$}
                        \RightLabel{$c$}\UnaryInfC{$\vdash \Gamma, A$}
                        \AxiomC{$\vdash \Gamma, B$}
                        \RightLabel{$\wedge$}\BinaryInfC{$\vdash \Gamma, A \wedge B$}
                    \end{prooftree}
                \end{minipage}
                $\leadsto\quad$
                \begin{minipage}[H]{0.5\linewidth}
                    \begin{prooftree}
                        \AxiomC{$\vdash \Gamma, A, A$}
                        \AxiomC{$\vdash \Gamma, B$}
                        \RightLabel{$w$}\UnaryInfC{$\vdash \Gamma, A, B$}
                        \RightLabel{$\wedge$}\BinaryInfC{$\vdash \Gamma, A, A \wedge B$}
                        \AxiomC{$\vdash \Gamma, B$}
                        \RightLabel{$w$}\UnaryInfC{$\vdash \Gamma, B, A \wedge B$}
                        \RightLabel{$\wedge$}\BinaryInfC{$\vdash \Gamma, A \wedge B, A \wedge B$}
                        \RightLabel{$c$}\UnaryInfC{$\vdash \Gamma, A \wedge B$}
                    \end{prooftree}
                \end{minipage}
            \end{minipage}\\~\\
            
            By induction from the leaves downwards on a finite height tree, apply the associated rule to each pair of inferences of the form ($c$ above \textit{inf}).
            Any given $\vdash P$ may be rewritten:
            \begin{prooftree}
                \AxiomC{}
                \RightLabel{$\top, ax$}\doubleLine\UnaryInfC{$\vdash A_1$}
                \RightLabel{$\wedge, \vee, w$}\doubleLine\UnaryInfC{$\vdash \Gamma_1$}
                \AxiomC{\ldots}
                \AxiomC{}
                \RightLabel{$\top, ax$}\doubleLine\UnaryInfC{$\vdash A_n$}
                \RightLabel{$\wedge, \vee, w$}\doubleLine\UnaryInfC{$\vdash \Gamma_n$}
                \RightLabel{$c$}\doubleLine\TrinaryInfC{$\vdash P$}
            \end{prooftree}
            
            Again, by induction from the root upwards on this partially stratified tree, apply the associated rule to each pair of inferences of the form ($w$ below \textit{inf}).
            $\vdash P$ may then be further rewritten:
            \begin{prooftree}
                \AxiomC{}
                \RightLabel{$\top, ax$}\doubleLine\UnaryInfC{$\vdash A_1$}
                \RightLabel{$w$}\doubleLine\UnaryInfC{$\vdash \Gamma_1$}
                \AxiomC{\ldots}
                \AxiomC{}
                \RightLabel{$\top, ax$}\doubleLine\UnaryInfC{$\vdash A_n$}
                \RightLabel{$w$}\doubleLine\UnaryInfC{$\vdash \Gamma_n$}
                \RightLabel{$\wedge, \vee$}\doubleLine\TrinaryInfC{$\vdash P \ldots P$}
                \RightLabel{$c$}\doubleLine\UnaryInfC{$\vdash P$}
            \end{prooftree}

        \end{proof}
 

    % ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


    \section{Coalescence}
        
        \begin{definition}{Petri Nets\\}
            For the purposes required here, a \textit{petri net} $\mathcal{N}$ is $(\mathcal{P, F})$ where $f \in \mathcal{F} : \mathcal{P}^m \times \mathcal{P}$.
            In particular, $\mathcal{P}$ is a set of places and $\mathcal{F}$ a set of flows.
            A \textit{configuration} is a set $\mathcal{C} \subset \mathcal{P}$ of tokens in places.
        \end{definition}

        \begin{example*}
        \end{example*}


        \begin{definition}{Firing Petri Nets\\}
            Given a petri net $\mathcal{N}$ and configuration $\mathcal{C}$, a \textit{firing} of the net $\mathcal{N}$ is a new configuration generated by application of a transition $f \in \mathcal{F}$ on $m$ tokens $c_1 \ldots c_n \in \mathcal{C}$.
            In particular, $(\mathcal{N = (P, F), C}) \mapsto (\mathcal{N, C} \cup f_{right} \setminus f_{left})$ for some $f = (f_{left}, f_{right}) \in \mathcal{F}$
            
            A petri net is said to be \textit{exhaustively fired} if it is fired until there does not exist any such $f \in \mathcal{F}$ to fire.
        \end{definition}

        \begin{example*}
        \end{example*}

        \begin{remark}
            Implementing fireable petri nets is straightforward using an $n$-dimensional boolean array of places visited and a collection of $n$-tuples representing tokens.
        \end{remark}

        
        \begin{definition}{Coalescence\\}
            Given a formula $P$, the coalescence algorithm is as follows:
            \begin{enumerate}[noitemsep]
                \item Set  $n := 1$
                \item Construct a $n$-dimensional petri net $\mathcal{N}$ from $P$ where each subformula is a place, each conjunction and disjunction a flow
                \item Construct a configuration $C$ with a token at each place $p = (\ldots, a, \ldots, \neg a, \ldots)$ the intersection of a pair of tautological atoms
                \item Exhaustively fire the petri net $\mathcal{N}$ using the \textit{spawning} method.
                \item If there exists a token in the configuration $\mathcal{C^*}$ at the root of the formula $P$, halt and return $n$
                \item Otherwise, set $n := n + 1$ and go to step 2
            \end{enumerate}
        \end{definition}


        \begin{proposition}{Coalescence Proof Search\\}
            The coalescence algorithm on $P$ is exactly a proof search on $P$.
        \end{proposition}

        \begin{proof}
            In particular, consider the additively stratified $\vdash P$ with $n - 1$ contractions.
            The first configuration of tokens is precisely a proof all possible combinations of the \textit{axiom} rule with $n - 3$ other terms through the \textit{weakening}.
            Each flow transition followed when fired is an application of either the $\vee$ or $\wedge$ rule.
            Finally, a token at the root of the formula is $\vdash P \ldots P$, with the \textit{contraction} rule applied implicitly.

            If there exists an additively stratified proof of $P$, the coalescence algorithm will find it.
            Since for every proof there exists an additively stratified proof, coalescence is precisely proof search.
        \end{proof}
 

    % ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


    \section{Dimensionality}
        
        \begin{definition}{Dimensionality\\}
            Coalescence proof search produces a proof in $n$ dimensions.
            Equivalently, an additively stratified sequent proof requires $n - 1$ contractions at the bottom of the proof.
            Given $\vdash P$, its dimensionality is defined $dim(P) \defeq n$.
        \end{definition}


        \begin{proposition}{Deducing Dimensionality\\}
            Given formulae $P, Q$ such that $\exists \vdash P$ with $dim(P) = n$ and $\exists \vdash Q$ with $dim(Q) = m$, then:
            \begin{align*}
                dim(P \vee Q) &= min(n, m) \\
                dim(P \wedge Q) &= max(n, m)
            \end{align*}
        \end{proposition}

        \begin{proof}
            Omitted
        \end{proof}


        \begin{definition}{Satisfiability vs Proveability\\}
            Coalescence $O(l^n)$ vs SAT $O(n$!$)$
        \end{definition}
        
        
        \begin{definition}{Dimensionality when not Proveable\\}
            $dim(P) \defeq$ dimension when a token last moved up the tree
        \end{definition}


        \begin{definition}{Paths in a Tree\\}
            Path from root to any leaf
        \end{definition}


        \begin{theorem}{Bounds on Coalescence Dimensionality\\}
            $dim(P) \leq \#\{\vee \in P\}$ \\
            $dim(P) \leq max\{\#\{\vee \in path\} \, \forall \, path \in tree(P)\}$

        \end{theorem}

        \begin{proof}
        \end{proof}


\end{document}
